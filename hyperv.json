{
    "builders": [
      {
        "vm_name":"{{user `os_version`}}{{user `os_edition`}}",
        "type": "hyperv-iso",
        "disk_size": 40000,
        "secondary_iso_images": [
          "build/{{user `os_version`}}{{user `os_edition`}}/secondary.iso"
        ],
        "boot_command": [
          "<esc><enter><wait2><esc><enter>"
        ],
        "iso_url": "{{ user `iso_url`}}",
        "iso_checksum_type": "{{ user `iso_checksum_type`}}",
        "iso_checksum": "{{ user `iso_checksum`}}",
        "communicator":"winrm",
        "winrm_username": "{{ user `username`}}",
        "winrm_password": "{{ user `password`}}",
        "winrm_timeout" : "4h",
        "shutdown_timeout": "60m",
        "shutdown_command": "schtasks.exe /Run /TN \"packer-shutdown\"",
        "ram_size": 2048,
        "cpu": 4,
        "generation": 2,
        "switch_name":"{{ user `switch`}}"
      }
    ],
    
    "provisioners": [
      {
        "type": "powershell",
         "elevated_user":"{{ user `username`}}",
         "elevated_password":"{{ user `password`}}",
        "scripts": [
         "{{template_dir}}/scripts/common/set-proxy.ps1",
         "{{template_dir}}/scripts/common/cloudbase-install.ps1"

        ]
      },
      {
        "type": "windows-update"
      },   
      {
        "type": "powershell",
        "scripts": [
          "{{template_dir}}/scripts/common/optimize.ps1",
          "{{template_dir}}/scripts/common/set-proxy.ps1",
          "{{template_dir}}/scripts/common/setsetupcomplete.ps1"          
        ]
      }
    ],
    "variables": {
      "os_edition":"std",
      "os_version": "win2016",
      "username": "Administrator",
      "password": "Pa$$W0rd",
      "iso_url": "",
      "iso_checksum":"",
      "iso_checksum_type":"md5",
      "secondary_isos": "",
      "switch": "NATSwitch"
  }
}